<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                      "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<title>TLSMD: Documentation</title>
<style type="text/css" media=screen>
<!--   BODY { background-color: white; margin-left: 5%;   margin-right: 5%; 
              border-left: 5%;         border-right: 5%;  margin-top: 2%; 
              border-top: 2%;}
-->
</style>
</head>
<body>

<center><h1>TLSMD: TLS Minimized Domains</h1></center>

<center>
<a href="/~jpaint/webtlsmd/index.html">Home</a>
&nbsp;&nbsp;&nbsp;&nbsp;
<a href="/~jpaint/cgi-bin/webtlsmd.cgi?page=submit1">Start a New Job</a>
&nbsp;&nbsp;&nbsp;&nbsp;
<a href="/~jpaint/cgi-bin/webtlsmd.cgi">Job Status</a>
&nbsp;&nbsp;&nbsp;&nbsp;
<a href="/~jpaint/webtlsmd/examples/index.html">Examples</a>
&nbsp;&nbsp;&nbsp;&nbsp;
Documentation
</center>

<br>


<center><h3>
<a name="how">How Does TLSMD Work?</a>
</h3></center>
<p>
TLSMD uses a two-stage optimization algorithm to select the optimal 1-group,
2-group, 3-group, ..., n-group partition of a protein chain into multiple
TLS groups.  This optimization is performed for each chain in a structure independently, so the TLS groups selected for multiple homologous chains in a input structure may be compared without any bias (unless the structure was refined with NCS restraints or constraints).  The first stage of the optimization feeds every possible residue sequence subsegment of the input protein chain to a subroutine which fits TLS model parameters to the refined ADPs of the atoms it contains.  The subroutine returns the TLS model parameters and least-squares residual of the input structure's refined ADPs vs. TLS calculated ADPs.  This information is temporarily stored in a database.  Once the database for the chain is complete, it contains every possible sequence continuous TLS group for the chain; all that is needed is to select the TLS groups from the database which best fit the input structure's refined ADPs as measured by the TLS group's least-squares residual.  This selection is performed by the second stage of the TLSMD optimization algorithm.  To accomplish this, a graph is constructed spanning the residue sequence of the chain by placing a vertex between every residue in the sequence, as well as a source vertex before the first residue, and a destination vertex after the last residue in the chain<small>(see Figure 1)</small>.  Graph edges are then constructed for each TLS group in the database spanning the vertexes which correspond to the TLS group's residue segment.  The edge cost, or weight, is the least-squares residual of the TLS group it represents.  Once this graph is constructed, a single source shortest path algorithm (our own constrained version of Bellman-Ford) is used to find the least cost path from the source vertex at the beginning of the chain sequence to the destination vertex at the end of the sequence.  The TLS groups corresponding to the edges used in the minimization path are those presented by TLSMD.
</p>

<center>
<table>
<tr><td align="center"><img src="tlsmd_graph_construct.png"></td></tr>
<tr><th>Figure 1: TLSMD Graph Construction of a 5 Residue Protein</th></tr>
</table>
</center>

<br>

<center><h3>
<a name="refmac5">
How-To Use TLSMD Selected TLS Groups in Refmac5 TLS Refinement
</a>
</h3></center>
<p>
The optimized TLS groups calculated by TLSMD from a isotropically refined structure may be used to further refine the structure with the TLS + restrained refinement mode of Refmac5.  Given the number of TLS groups you would like to use for each chain, TLSMD can generate a special structure model file (PDBIN also called XYZIN) and TLS tensor file(TLSIN) you can use as input files to Refmac5.  These files are generated specifically for Refmac5 refinement by splitting the temperature factor magnitude of each atom between the TLS model and individual atomic temperature factors.  Because of this, the TLS model for refinement is different than the one used for motion analysis.  To generate these input files, click on the <b>Use Optimal TLS Groups with Refmac5 TLS Refinement</b> web page which is on the root <b>TLSMD Rigid Body Analysis</b> page generated for your structure.  After you have generated and downloaded these files, you may use them through either the CCP4i GUI interface, or by writing your own custom shell script which invokes Refmac5.  Examples of both methods are described below.
</p>

<p>
Below is a screen shot of the CCP4i interface with the proper settings to perform refinement on structure 1X6O.  The PDBIN file generated by TLSMD is <i>1X60_CHAINA_NTLS6.pdb</i>, and the TLSIN file is <i>1X60_CHAINA_NTLS6.tlsin</i>.  This is a single-chain protein partitioned into six TLS groups for refinement.  Notice that the <i>Set initial Bfactors to</i> option is <b>not</b> checked.  This is important: if this option is set, it will override the Bfactors calculated by TLSMD and which are in the input PDB file.  This will result in a poor and possibly unstable refinement.
</p>
<center><img src="ccp4i_tls.png"></center>

<p>
If you prefer using a shell script to run Refmac5, below is a example using the same structure files shown in the example above.
</p>

<pre>
#!/bin/bash

refmac5 HKLIN  1X60.mtz \
        HKLOUT 1X60.OUT.mtz \
        XYZIN  1X6O_CHAINA_NTLS6.pdb \
        XYZOUT 1X60.pdb \
        TLSIN  1X6O_CHAINA_NTLS6.tlsin \
        TLSOUT 1X60.tlsout &#60;&#60;EOF
MAKE HYDR ALL
MAKE CHECK NONE

LABI FP=F SIGFP=SIGF FREE=FreeR_flag
REFI TYPE REST RESO 20.0 1.6

REFI RESI MLKF
REFI BREF ISOT

WEIG MATR 1.0

SCAL TYPE BULK
SCAL LSSC ANIS
SCAL MLSC

REFI TLSC 10
NCYC 10

MONI MANY
BINS 10

EOF
</pre>

<p>
The table below shows the results of TLS refinement of 1X60 using 1 to 19 TLS groups selected by TLSMD.
</p>

<center>
<table border="1">
<tr><th>Num. TLS Groups</th>
    <th>RFac</th>
    <th>RFree</th>
    <th>FOM</th>
    <th>RMS Bonds</th>
    <th>RMS Angle</th>
    <th>RMS Chiral</th>
</tr>
<tr>
<td>1</td><td>0.166</td><td>0.198</td><td>0.882</td><td>0.019</td><td>  1.740</td><td>0.126</td></tr>
<tr>
<td>2</td><td>0.163</td><td>0.195</td><td>0.886</td><td>0.018</td><td>  1.716</td><td>0.123</td></tr>
<tr>
<td>3</td><td>0.162</td><td>0.194</td><td>0.888</td><td>0.018</td><td>  1.710</td><td>0.125</td></tr>
<tr>
<td>4</td><td>0.162</td><td>0.194</td><td>0.889</td><td>0.018</td><td>  1.689</td><td>0.124</td></tr>
<tr>
<td>5</td><td>0.160</td><td>0.191</td><td>0.891</td><td>0.018</td><td>  1.668</td><td>0.123</td></tr>
<tr>
<td>6</td><td>0.160</td><td>0.189</td><td>0.893</td><td>0.018</td><td>  1.663</td><td>0.121</td></tr>
<tr>
<td>7</td><td>0.160</td><td>0.188</td><td>0.893</td><td>0.018</td><td>  1.656</td><td>0.123</td></tr>
<tr>
<td>8</td><td>0.159</td><td>0.188</td><td>0.893</td><td>0.017</td><td>  1.645</td><td>0.123</td></tr>
<tr>
<td>9</td><td>0.159</td><td>0.189</td><td>0.893</td><td>0.018</td><td>  1.644</td><td>0.122</td></tr>
<tr>
<td>10</td><td>0.159</td><td>0.189</td><td>0.893</td><td>0.017</td><td>  1.636</td><td>0.121</td></tr>
<tr>
<td>11</td><td>0.158</td><td>0.189</td><td>0.893</td><td>0.017</td><td>  1.627</td><td>0.121</td></tr>
<tr>
<td>12</td><td>0.158</td><td>0.189</td><td>0.893</td><td>0.017</td><td>  1.623</td><td>0.121</td></tr>
<tr>
<td>13</td><td>0.158</td><td>0.189</td><td>0.894</td><td>0.017</td><td>  1.621</td><td>0.122</td></tr>
<tr>
<td>14</td><td>0.157</td><td>0.189</td><td>0.895</td><td>0.017</td><td>  1.621</td><td>0.123</td></tr>
<tr>
<td>15</td><td>0.158</td><td>0.188</td><td>0.895</td><td>0.017</td><td>  1.620</td><td>0.122</td></tr>
<tr>
<td>16</td><td>0.157</td><td>0.188</td><td>0.895</td><td>0.017</td><td>  1.621</td><td>0.122</td></tr>
<tr>
<td>17</td><td>0.157</td><td>0.188</td><td>0.895</td><td>0.017</td><td>  1.619</td><td>0.122</td></tr>
<tr>
<td>18</td><td>0.157</td><td>0.187</td><td>0.895</td><td>0.017</td><td>  1.621</td><td>0.124</td></tr>
<tr>
<td>19</td><td>0.157</td><td>0.187</td><td>0.896</td><td>0.017</td><td>  1.622</td><td>0.124</td></tr>
</table>
</center>


<center><p><small>Last Modified July 7, 2005</small></p></center>
</body></html>

